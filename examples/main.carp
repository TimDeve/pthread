(load "../pthread.carp")

(use-all Thread Result Array)

(defn main []
 (let-do [avalue 42
          fun &(fn []
                 (let-do [rand &(Int.random-between 0 1000000)]
                  (System.sleep-micros @rand)
                  (println* (fmt "avalue: %i, rand: %i" avalue @rand))))]
  (Random.seed)
  (join-all (repeat 10 &(fn [] (unsafe-from-success (create fun)))))))

